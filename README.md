Описание работы рекомендательной системы.


 рекомендация состоит из 3-х частей:
  - персональные рекомендация "alc_rec"
  - топ популярных треков "pop_rec"
  - рекомендации на основе похожести треков i2i "sim_items"


 Рекомендайии "sim_items" - является онлайн частью рекомендательной системы. Факт прослушивания трека означает возможность использовать "sim_items" передав в параметре "item_id" соответствующий идентификатор трека. Наличие в "item_id" значения отличного от -1 (-1 ознаяает что "sim_items" не используется) в нашем случае заменяет "Event Store" и "Feature Store"


 После получения рекомендайии из всех источников мы используем ранжирующую модель, чтобы отобрать 10 самых подходящих рекомендации. Это и есть способ смешивания рекомендаций из онлайн и оффлайн.
 

 Признаки для модели разнесены по трем таблицам из s3 в зависимости от того, к чему относятся эти признаки
 
  - признаки "user_id" в таблице "recsys/recommendations/rank_features/user.parquet"
  - признаки "item_id" в таблице "recsys/recommendations/rank_features/item.parquet"
  - признаки пары ("user_id", "item_id") в таблице "recsys/recommendations/rank_features/user_item.parquet"
 
 При обновлении таблиц появляется необходимость перезапуска сервиса, в реальных задачах лучше использовать СУБД


----------------


Запуск рекомендательной системы.


 - переходим в директорию "services"
 - создаем виртуальное окружение и заходим в него
    >python3.10 -m venv .venv_deploy
    >source .venv_deploy/bin/activate
 - устанавливаем все модули из "requirements.txt"
    >pip install -r requirements.txt
 - запускаем сервис
    >uvicorn ml_service.rec_app:app --reload --port 8081 --host 0.0.0.0


----------------

Запуск теста


 - в новом консольном окне переходим в директорию "services"
 - запускаем python-скрипт
    >python3 tests/test_service.py
 - в файл "test_service.log" будут записаны примеры ответов от сервиса